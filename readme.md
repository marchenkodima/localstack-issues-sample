# Steps to reproduce:
1. Run `LOCALSTACK_API_KEY={your_api_key} npm run localstack`
2. Run `npm run deploy` to run deployment against localstack
3. Create a user by sending a POST request to `{api_url}/create-end-user` with the following payload (Body):
```
{
  "email": "test3@email.com",
  "phone_number": "+12131234124",
  "name": "First Last",
  "password": "password1!"
}
```
As a result it will create a user in old user pool.

4. Sign in by sending a POST request to `{api_url}/sign-in` with the following payload (Body):
```
{
  "email": "test3@email.com",
  "password": "password1!"
}
```
It will migrate the create user to a new user pool.

5. Run `awslocal cognito-idp list-user-pools --region us-west-2 --max-results 10`. Copy user pool id of the v2 end user pool. And run `awslocal cognito-idp list-users --user-pool-id {user_pool_id_you_copied}`

The `Username` field was assigned to autogenerated value. And the specified `username` was added to `Attributes`

```
{
    "Users": [
        {
            "Username": "18acecd9-42a0-4472-9fb4-626b41582fe0",
            "Attributes": [
                {
                    "Name": "email",
                    "Value": "test3@email.com"
                },
                {
                    "Name": "email_verified",
                    "Value": "true"
                },
                {
                    "Name": "phone_number",
                    "Value": "+12131234123"
                },
                {
                    "Name": "name",
                    "Value": "First Last"
                },
                {
                    "Name": "username",
                    "Value": "customhc52a0jnj8g"
                },
                {
                    "Name": "sub",
                    "Value": "18acecd9-42a0-4472-9fb4-626b41582fe0"
                },
                {
                    "Name": "cognito:username",
                    "Value": "18acecd9-42a0-4472-9fb4-626b41582fe0"
                }
            ],
            "UserCreateDate": 1722855982.236474,
            "UserLastModifiedDate": 1722855982.236474,
            "Enabled": true,
            "UserStatus": "CONFIRMED"
        }
    ]
}
```

6. Run deployment against a live environment. E.g. `AWS_PROFILE=your_profile STAGE=dev npm run deploy`
7. Repeat steps 3, 4, and step 5 but replace `awslocal` command with `aws`

The result will be different and what we actually expect. The `Username` field is assigned to a value that we provided.
```
{
    "Users": [
        {
            "Username": "customtn9ee14yc6",
            "Attributes": [
                {
                    "Name": "email",
                    "Value": "test3@email.com"
                },
                {
                    "Name": "email_verified",
                    "Value": "true"
                },
                {
                    "Name": "phone_number",
                    "Value": "+12131234124"
                },
                {
                    "Name": "name",
                    "Value": "First Last"
                },
                {
                    "Name": "sub",
                    "Value": "18312320-60d1-707b-9871-2d73345583d4"
                }
            ],
            "UserCreateDate": "2024-08-05T15:47:10.139000+03:00",
            "UserLastModifiedDate": "2024-08-05T15:47:10.139000+03:00",
            "Enabled": true,
            "UserStatus": "CONFIRMED"
        }
    ]
}
```